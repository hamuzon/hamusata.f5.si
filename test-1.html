<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>HAMUSATA – ホームページ</title>

  <!-- Favicon -->
  <link rel="icon" href="https://hamusata.f5.si/favicon.ico" type="image/x-icon">
  <link rel="icon" type="image/png" href="https://hamusata.f5.si/icon.png" sizes="32x32">
  <link rel="icon" type="image/webp" href="https://hamusata.f5.si/icon.webp" sizes="32x32">
  <link rel="icon" type="image/svg+xml" href="https://hamusata.f5.si/icon.svg">
  <link rel="apple-touch-icon" href="https://hamusata.f5.si/icon.png">

  <!-- PWA manifest -->
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#000000">

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Potta+One&display=swap" rel="stylesheet">

  <!-- Base CSS -->
  <link rel="stylesheet" href="css/style.css">

  <!-- モバイルメニュー & Cookieバナー CSS -->
  <style>
    /* ハンバーガーメニュー */
    #menu-toggle {
      position: fixed;
      top: 16px;
      right: 16px;
      width: 48px;
      height: 48px;
      background: transparent;
      border: none;
      cursor: pointer;
      z-index: 1001;
      display: flex;
      flex-direction: column;
      justify-content: space-around;
      padding: 10px;
      box-sizing: border-box;
      transition: transform 0.4s ease;
    }
    #menu-toggle span {
      display: block;
      height: 4px;
      background-color: #000;
      border-radius: 2px;
      transition: all 0.4s ease;
    }
    body.dark #menu-toggle span { background-color: #fff; }
    #menu-toggle.active span:nth-child(1) { transform: rotate(-45deg) translate(-6px,6px); }
    #menu-toggle.active span:nth-child(2) { opacity: 0; }
    #menu-toggle.active span:nth-child(3) { transform: rotate(45deg) translate(-6px,-6px); }

    /* モバイルメニュー */
    #mobile-menu {
      position: fixed;
      top: 0;
      right: -100%;
      width: 75%;
      max-width: 320px;
      height: 100vh;
      padding-top: 80px;
      border-radius: 16px 0 0 16px;
      overflow-y: auto;
      z-index: 1000;
      background: rgba(255,255,255,0.12);
      backdrop-filter: blur(28px) saturate(120%);
      box-shadow: -8px 0 24px rgba(0,0,0,0.25);
      transition: right 0.4s ease, background 0.3s;
    }
    body.dark #mobile-menu { background: rgba(10,10,10,0.6); }
    #mobile-menu.open { right:0; }
    #mobile-menu ul { list-style:none; padding:0; margin:0; }
    #mobile-menu li { margin:0; }
    #mobile-menu a {
      display:block;
      padding:18px 24px;
      font-size:18px;
      color: var(--md-sys-color-on-surface,#000);
      text-decoration:none;
      border-radius:12px;
      margin:6px 12px;
      border-bottom:1px solid rgba(0,0,0,0.05);
      background: rgba(255,255,255,0.08);
      backdrop-filter: blur(22px);
      transition: background 0.3s, color 0.3s, transform 0.3s;
    }
    body.dark #mobile-menu a { color:#fff; border-bottom:1px solid rgba(255,255,255,0.05); }
    #mobile-menu a:hover { background-color: rgba(0,188,212,0.2); color: #00bcd4; transform: translateX(4px); }

    /* メニューオーバーレイ */
    #menu-overlay {
      position: fixed;
      top:0;
      left:0;
      width:100%;
      height:100vh;
      background-color: rgba(0,0,0,0.5);
      opacity:0;
      visibility:hidden;
      transition: opacity 0.4s ease;
      z-index:900;
    }
    #menu-overlay.active { opacity:1; visibility: visible; }

    /* レスポンシブ */
    @media(max-width:480px){
      #mobile-menu{width:85%; padding-top:70px;}
      #mobile-menu a{font-size:16px; padding:14px 20px;}
    }
  </style>
</head>

<body class="light">

  <!-- Cookieバナー -->
  <div id="cookie-banner">
    <p>このサイトではCookieを使用します。</p>
    <p>
      <button id="minimal-cookie">必要最低限のみ</button>
      <button id="accept-all-cookie">全て許可</button>
      <button id="reject-cookie">拒否</button>
    </p>
  </div>

  <!-- ヘッダー -->
  <header>
    <a href="index.html" class="banner-link">
      <img src="hamusata_399-120.webp" alt="hamusata home banner" width="399" height="120" loading="lazy" decoding="async">
    </a>

    <button id="menu-toggle" aria-label="メニューを開く" aria-expanded="false">
      <span></span><span></span><span></span>
    </button>

    <nav id="mobile-menu">
      <ul>
        <li><a href="#home">ホーム</a></li>
        <li><a href="#profile">自己紹介</a></li>
        <li><a href="#portfolio">ポートフォリオ</a></li>
        <li><a href="#random">ランダム作品</a></li>
        <li><a href="#status">サービス稼働状況</a></li>
        <li><a href="#mutual-links">相互リンク</a></li>
        <li><a href="#sns">SNSリンク</a></li>
        <li><a href="terms.html">利用規約・プライバシーポリシー</a></li>
        <li>
          <a href="https://github.com/hamuzon/hamusata.f5.si" target="_blank" rel="noopener noreferrer" style="display:flex;align-items:center;gap:6px;">
            <img src="https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png" alt="GitHub" style="width:20px;height:20px;border-radius:50%;padding:2px;background:#222;">
            site-Code-GitHub
          </a>
        </li>
      </ul>
    </nav>
    <div id="menu-overlay"></div>

    <!-- 広告 -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7413522404678991" crossorigin="anonymous"></script>
  </header>

  <main>
    <h1>HAMUSATA ホームページ</h1>

    <!-- 自己紹介 -->
    <section id="profile">
      <h2>自己紹介</h2>
      <p>こんにちは、hamusataです。webサイトを作ったりネットをしてるネットの海の住民。</p>
      <p>ハムスターを飼っています。</p>
      <p>ネットの海でプログラミングしたりネットしたりして過ごしてます。</p>
    </section>

    <!-- ポートフォリオ -->
    <section id="portfolio">
      <h2>ポートフォリオリンク集</h2>
      <div class="works" id="portfolioLinks"></div>
    </section>

    <!-- ランダム作品 -->
    <section id="random">
      <h2>ランダム作品</h2>
      <div class="works" id="randomLinks"></div>
    </section>

    <!-- サービス稼働状況 -->
    <section id="status">
      <h2>サービス稼働状況</h2>
      <div class="works" id="statusLinks"></div>
    </section>

    <!-- 相互リンク -->
    <section id="mutual-links">
      <h2>相互リンク</h2>
      <div class="works" id="mutualLinks"></div>
    </section>

    <!-- SNSリンク -->
    <section id="sns">
      <h2>SNSリンク</h2>
      <div class="works" id="snsLinks"></div>
    </section>
  </main>

  <!-- フッター -->
  <footer>
    &copy; <span id="year"></span> <a href="https://github.com/hamuzon">@hamuzon / @hamusata</a> – All rights reserved.
  </footer>

  <!-- JS -->
  <script src="js/links-sub.js"></script>
  <script src="js/script-sub.js"></script>

  <script>
    document.addEventListener("DOMContentLoaded", () => {

      // 年自動更新
      document.getElementById("year").textContent = new Date().getFullYear();

      // ----------------------
      // Cookieバナー制御 & GA読み込み
      // ----------------------
      const cookieBanner = document.getElementById("cookie-banner");
      const showCookieBanner = () => {
        const consent = localStorage.getItem("cookieConsent");
        if (!consent) cookieBanner.style.display = "block";
      };
      const hideCookieBanner = (choice) => {
        localStorage.setItem("cookieConsent", choice);
        cookieBanner.style.display = "none";

        // GAロード
        if (choice === "all" || choice === "minimal") {
          const minimal = choice === "minimal";
          if (!window.__GA_LOADED__) {
            const gtagScript = document.createElement("script");
            gtagScript.async = true;
            gtagScript.src = 'https://www.googletagmanager.com/gtag/js?id=G-E3VWGLZJ27';
            document.head.appendChild(gtagScript);
            gtagScript.onload = () => {
              window.dataLayer = window.dataLayer || [];
              function gtag(){dataLayer.push(arguments);}
              window.gtag = gtag;
              gtag('js', new Date());
              gtag('config','G-E3VWGLZJ27',{ 
                anonymize_ip: minimal,
                allow_google_signals: !minimal,
                allow_ad_personalization_signals: !minimal
              });
              window.__GA_LOADED__ = true;
            };
          }
        }
      };

      document.getElementById("minimal-cookie").addEventListener("click", ()=>hideCookieBanner("minimal"));
      document.getElementById("accept-all-cookie").addEventListener("click", ()=>hideCookieBanner("all"));
      document.getElementById("reject-cookie").addEventListener("click", ()=>hideCookieBanner("reject"));

      // 初期表示
      const consent = localStorage.getItem("cookieConsent");
      if (consent === "minimal") hideCookieBanner("minimal");
      else if (consent === "all") hideCookieBanner("all");
      else if (consent === "reject") cookieBanner.style.display = "none";
      else showCookieBanner();

      // ----------------------
      // テーマ自動切替（URLパラメータ優先 + OS設定）
      // ----------------------
      const urlParams = new URLSearchParams(window.location.search);
      const themeParam = urlParams.get('theme');

      const applyTheme = (theme) => {
        document.body.classList.remove('light','dark');
        document.body.classList.add(theme);
      };

      if(themeParam==='dark'||themeParam==='light'){
        applyTheme(themeParam);
      } else {
        const osTheme = window.matchMedia('(prefers-color-scheme: dark)');
        applyTheme(osTheme.matches?'dark':'light');
        osTheme.addEventListener('change', e => applyTheme(e.matches?'dark':'light'));
      }

      // ----------------------
      // モバイルメニュー制御
      // ----------------------
      const menuToggle = document.getElementById("menu-toggle");
      const mobileMenu = document.getElementById("mobile-menu");
      const overlay = document.getElementById("menu-overlay");

      menuToggle.addEventListener("click", () => {
        const expanded = menuToggle.classList.toggle("active");
        mobileMenu.classList.toggle("open");
        overlay.classList.toggle("active");
        document.body.classList.toggle("menu-open");
        menuToggle.setAttribute("aria-expanded", expanded);
      });

      overlay.addEventListener("click", () => {
        mobileMenu.classList.remove("open");
        overlay.classList.remove("active");
        menuToggle.classList.remove("active");
        document.body.classList.remove("menu-open");
        menuToggle.setAttribute("aria-expanded", false);
      });

      document.querySelectorAll("#mobile-menu a").forEach(link=>{
        link.addEventListener("click",()=>{
          mobileMenu.classList.remove("open");
          overlay.classList.remove("active");
          menuToggle.classList.remove("active");
          document.body.classList.remove("menu-open");
          menuToggle.setAttribute("aria-expanded", false);
        });
      });

      // ----------------------
      // ページロード時ハッシュ削除
      // ----------------------
      if(location.hash) {
        history.replaceState(null,'',location.pathname+location.search);
        window.scrollTo({top:0});
      }

    document.addEventListener('DOMContentLoaded', function() {
      // 今のURLにthemeパラメータがあるか
      const params = new URLSearchParams(window.location.search);
      const theme = params.get('theme');
      if (!theme) return;

      document.querySelectorAll('a[data-inside]').forEach(function(a) {
        // Inside値が1のリンクだけ適用
        if (a.dataset.inside !== "1") return;

        // 既にthemeパラメータがついている場合は付加しない
        const linkUrl = new URL(a.getAttribute('href'), window.location.origin);
        if (linkUrl.searchParams.get('theme')) return;

        // 元のクエリも維持してthemeを追加
        linkUrl.searchParams.set('theme', theme);
        a.setAttribute('href', linkUrl.pathname + linkUrl.search + linkUrl.hash);
      });
    });
      
  </script>
 </body>
</html>
